2025-12-13 14:38:30,789 - INFO - run - Initializing database...
2025-12-13 14:38:31,047 - INFO - db - Database engine created successfully
2025-12-13 14:38:31,079 - INFO - db - DB initialized at threat_sentric_ai.db
2025-12-13 14:38:31,080 - INFO - run - Database initialized successfully
2025-12-13 14:38:31,080 - INFO - run - Starting scheduler...
2025-12-13 14:38:46,860 - INFO - run - Scheduler started successfully
2025-12-13 14:38:46,861 - INFO - run - Starting GUI...
2025-12-13 14:38:47,535 - INFO - gui - Initializing database for GUI...
2025-12-13 14:38:47,537 - INFO - db - Database engine created successfully
2025-12-13 14:38:47,541 - INFO - db - DB initialized at threat_sentric_ai.db
2025-12-13 14:38:47,542 - INFO - gui - Database initialized successfully
2025-12-13 14:38:48,402 - INFO - db - Database engine created successfully
2025-12-13 14:38:48,551 - INFO - gui - GUI refreshed.
2025-12-13 14:39:03,179 - INFO - gui - GUI refreshed.
2025-12-13 14:39:05,620 - INFO - gui - Manual scan started.
2025-12-13 14:39:05,621 - INFO - shodan_collector - Starting Shodan scan: query=product:apache limit=50
2025-12-13 14:39:06,517 - ERROR - shodan_collector - Shodan scan failed: Access denied (403 Forbidden)
Traceback (most recent call last):
  File "D:\visual code file\Project_3\ThreatSentry-AI-main\collectors\shodan_collector.py", line 65, in scan_shodan
    results = api.search(query, limit=limit)
  File "D:\visual code file\Project_3\ThreatSentry-AI-main\.venv\Lib\site-packages\shodan\client.py", line 571, in search
    return self._request('/shodan/host/search', args)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\visual code file\Project_3\ThreatSentry-AI-main\.venv\Lib\site-packages\shodan\client.py", line 389, in _request
    raise APIError('Access denied (403 Forbidden)')
shodan.exception.APIError: Access denied (403 Forbidden)
2025-12-13 14:39:06,524 - INFO - nvd_collector - Enriched devices with vulnerabilities.
2025-12-13 14:39:06,586 - INFO - gui - GUI refreshed.
2025-12-13 14:39:06,587 - INFO - gui - Manual scan finished.
2025-12-13 14:39:36,944 - INFO - gui - GUI refreshed.
2025-12-13 14:39:38,073 - INFO - gui - Manual scan started.
2025-12-13 14:39:38,074 - INFO - shodan_collector - Starting Shodan scan: query=hostname:".yourcompany.com" limit=50
2025-12-13 14:39:38,464 - ERROR - shodan_collector - Shodan scan failed: Access denied (403 Forbidden)
Traceback (most recent call last):
  File "D:\visual code file\Project_3\ThreatSentry-AI-main\collectors\shodan_collector.py", line 65, in scan_shodan
    results = api.search(query, limit=limit)
  File "D:\visual code file\Project_3\ThreatSentry-AI-main\.venv\Lib\site-packages\shodan\client.py", line 571, in search
    return self._request('/shodan/host/search', args)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\visual code file\Project_3\ThreatSentry-AI-main\.venv\Lib\site-packages\shodan\client.py", line 389, in _request
    raise APIError('Access denied (403 Forbidden)')
shodan.exception.APIError: Access denied (403 Forbidden)
2025-12-13 14:39:38,470 - INFO - nvd_collector - Enriched devices with vulnerabilities.
2025-12-13 14:39:38,545 - INFO - gui - GUI refreshed.
2025-12-13 14:39:38,546 - INFO - gui - Manual scan finished.
2025-12-13 14:39:48,470 - INFO - gui - GUI refreshed.
2025-12-13 14:40:13,762 - INFO - gui - Imported 10000 rows from D:/visual code file/Project_3/ThreatSentry-AI-main/data/generated_data/my_training_data.json -> added=10000 updated=0 skipped=0
2025-12-13 14:40:13,764 - INFO - model_training - Starting advanced model training
2025-12-13 14:40:23,644 - ERROR - db_reset - Failed to reset database: [WinError 32] The process cannot access the file because it is being used by another process: 'threat_sentric_ai.db'
2025-12-13 14:40:33,574 - INFO - db_reset - Deleted existing database at threat_sentric_ai.db
2025-12-13 14:40:33,576 - ERROR - db_reset - Failed to reset database: No module named 'db'
2025-12-13 14:40:35,636 - ERROR - db_reset - Failed to reset database: No module named 'db'
2025-12-13 14:40:36,833 - ERROR - db_reset - Failed to reset database: No module named 'db'
2025-12-13 14:41:04,829 - ERROR - db_reset - Failed to reset database: No module named 'db'
2025-12-13 14:41:20,954 - INFO - db - Database engine created successfully
2025-12-13 14:41:20,971 - INFO - db - DB initialized at threat_sentric_ai.db
2025-12-13 14:41:20,972 - INFO - db - Database engine created successfully
2025-12-13 14:41:30,276 - INFO - db_reset - Deleted existing database at threat_sentric_ai.db
2025-12-13 14:41:31,040 - INFO - db - Database engine created successfully
2025-12-13 14:41:31,061 - INFO - db - DB initialized at threat_sentric_ai.db
2025-12-13 14:41:31,062 - INFO - db_reset - Database initialized with new schema
2025-12-13 14:42:32,538 - INFO - db_reset - Deleted existing database at data/db/threat_sentric_ai.db
2025-12-13 14:42:33,167 - INFO - db - Database engine created successfully
2025-12-13 14:42:33,186 - INFO - db - DB initialized at data/db/threat_sentric_ai.db
2025-12-13 14:42:33,191 - INFO - db_reset - Database initialized with new schema
2025-12-13 14:42:37,788 - INFO - db - Database engine created successfully
2025-12-13 14:42:37,794 - INFO - db - DB initialized at data/db/threat_sentric_ai.db
2025-12-13 14:42:37,795 - INFO - db - Database engine created successfully
2025-12-13 14:43:00,961 - INFO - run - Initializing database...
2025-12-13 14:43:00,993 - INFO - db - Database engine created successfully
2025-12-13 14:43:00,995 - INFO - db - DB initialized at data/db/threat_sentric_ai.db
2025-12-13 14:43:00,996 - INFO - run - Database initialized successfully
2025-12-13 14:43:00,996 - INFO - run - Starting scheduler...
2025-12-13 14:43:03,078 - INFO - run - Scheduler started successfully
2025-12-13 14:43:03,079 - INFO - run - Starting GUI...
2025-12-13 14:43:03,100 - INFO - gui - Initializing database for GUI...
2025-12-13 14:43:03,102 - INFO - db - Database engine created successfully
2025-12-13 14:43:03,104 - INFO - db - DB initialized at data/db/threat_sentric_ai.db
2025-12-13 14:43:03,104 - INFO - gui - Database initialized successfully
2025-12-13 14:43:03,632 - INFO - db - Database engine created successfully
2025-12-13 14:43:03,747 - INFO - gui - GUI refreshed.
2025-12-13 14:43:18,691 - INFO - gui - Imported 1000 rows from D:/visual code file/Project_3/ThreatSentry-AI-main/data/generated_data/my_training_data.json -> added=1000 updated=0 skipped=0
2025-12-13 14:43:18,692 - INFO - model_training - Starting advanced model training
2025-12-13 14:43:21,614 - INFO - model_training - Model and metadata saved to data/models/rf_model.pkl
2025-12-13 14:43:21,615 - INFO - model_training - Model training completed successfully
2025-12-13 14:43:21,615 - INFO - model_training - Validation accuracy: 0.975
2025-12-13 14:43:26,903 - INFO - gui - GUI refreshed.
2025-12-13 14:43:58,821 - ERROR - email_alerts - Failed to send email via SendGrid: HTTP Error 401: Unauthorized
Traceback (most recent call last):
  File "D:\visual code file\Project_3\ThreatSentry-AI-main\alerts\email_alerts.py", line 85, in send_email_alert
    response: Any = sg.send(message)
                    ~~~~~~~^^^^^^^^^
  File "D:\visual code file\Project_3\ThreatSentry-AI-main\.venv\Lib\site-packages\sendgrid\base_interface.py", line 63, in send
    return self.client.mail.send.post(request_body=message)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "D:\visual code file\Project_3\ThreatSentry-AI-main\.venv\Lib\site-packages\python_http_client\client.py", line 277, in http_request
    self._make_request(opener, request, timeout=timeout)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\visual code file\Project_3\ThreatSentry-AI-main\.venv\Lib\site-packages\python_http_client\client.py", line 184, in _make_request
    raise exc
python_http_client.exceptions.UnauthorizedError: HTTP Error 401: Unauthorized
2025-12-13 14:43:58,888 - ERROR - gui - Failed to send filtered alerts: HTTP Error 401: Unauthorized
Traceback (most recent call last):
  File "D:\visual code file\Project_3\ThreatSentry-AI-main\gui\app.py", line 917, in send_filtered_alerts
    send_email_alert(warning_subject, html)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\visual code file\Project_3\ThreatSentry-AI-main\alerts\email_alerts.py", line 85, in send_email_alert
    response: Any = sg.send(message)
                    ~~~~~~~^^^^^^^^^
  File "D:\visual code file\Project_3\ThreatSentry-AI-main\.venv\Lib\site-packages\sendgrid\base_interface.py", line 63, in send
    return self.client.mail.send.post(request_body=message)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "D:\visual code file\Project_3\ThreatSentry-AI-main\.venv\Lib\site-packages\python_http_client\client.py", line 277, in http_request
    self._make_request(opener, request, timeout=timeout)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\visual code file\Project_3\ThreatSentry-AI-main\.venv\Lib\site-packages\python_http_client\client.py", line 184, in _make_request
    raise exc
python_http_client.exceptions.UnauthorizedError: HTTP Error 401: Unauthorized
2025-12-13 14:44:06,350 - INFO - gui - GUI refreshed.
